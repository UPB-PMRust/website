
# HydroSense

An ESP32-based irrigation controller written in Rust, using soil moisture + rain sensing and MQTT telemetry.

:::info


**Author:** Cătălina Nedelcu-Holtea (`catalina_nedelcu.holtea`)  
**GitHub Project Link:**

:::

## Description

<div style="text-align: justify;">
HydroSense is an ESP32-based irrigation controller written in Rust, designed to automate watering decisions using real sensor data. The system reads a soil moisture sensor and a rain sensor, then switches a 12 V water pump through an N-channel MOSFET stage when irrigation is needed. In parallel, it publishes status and measurements via MQTT, which enables remote monitoring and makes testing/debugging significantly easier.
</div>

## Motivation

<div style="text-align: justify;">
I am particularly interested in embedded and IoT systems because they connect software to the physical world in a direct and measurable way—through sensing, decision-making, and reliable control of real hardware. These concepts are fundamental to understanding many technologies we interact with daily, from smart home devices and environmental monitoring to agriculture/greenhouse automation and industrial control.
</div>

<div style="text-align: justify;">
At the same time, HydroSense started from a personal need. I genuinely enjoy taking care of plants, but watering often becomes a routine task that is easy to forget during busy periods. I have experienced situations where inconsistent watering led to plants drying out and dying. This project is my practical solution: a small, dependable system that handles watering based on actual conditions, not memory or fixed schedules.
</div>

## Architecture

![Architecture diagram](./architecture.svg)

### Main components

- **ESP32 (main controller + Wi-Fi):**  
  The ESP32 is responsible for the full control loop: it reads the soil moisture and rain sensors, decides whether irrigation is required, and controls the relay module that switches the pump. In parallel, it connects to Wi-Fi and communicates with an MQTT broker to publish telemetry and receive remote commands.

- **Soil moisture sensor (probe + LM393 module):**  
  The probe behaves like a variable resistor whose value changes with soil moisture. The LM393 board conditions the signal and provides two outputs:
  - **AO (analog output):** a continuous voltage that can be sampled by the ESP32 to obtain a real moisture level. Because the system uses Wi-Fi/MQTT, the analog output should be connected to an **ADC1 pin** (recommended) for stable readings.
  - **DO (digital output):** a comparator-based 0/1 signal generated by the LM393. The threshold is adjusted using the onboard potentiometer, and it can be used as a simple “dry/wet” detection input.

- **Rain sensor:**  
  Provides a rain/no-rain signal. This input is used as an additional condition to prevent watering when rain is detected.

- **Relay module:**  
  The relay acts as the power switching stage. It is driven by one ESP32 GPIO pin and electrically separates the low-voltage logic from the pump power line.

- **5 V water pump:**  
  The actuator that performs irrigation. It is powered from a dedicated 5 V supply and is switched ON/OFF through the relay module.

- **Tube (water delivery):**  
  Routes water from the pump to the plant/soil area.

- **MQTT broker + phone dashboard:**  
  The MQTT broker is the communication bridge between the device and the user interface. Telemetry is sent from the ESP32 to the broker, and the phone dashboard subscribes to it. The dashboard can also publish command messages that allow manual pump control.

### User interface

- **Monitoring (telemetry):**  
  The ESP32 publishes measurements and system state via MQTT (soil moisture level, rain status, pump state). This allows me to view the system status on my phone and validate behavior during testing.

- **Manual override:**  
  Although the system operates automatically, the pump can also be turned ON/OFF manually from the phone by sending an MQTT command. This is useful for exceptional situations and for controlled testing.

### Data flow summary

- Soil moisture sensor + rain sensor → ESP32 (measurements)  
- ESP32 → relay module → 5 V pump → tube (irrigation)  
- ESP32 ↔ MQTT broker ↔ phone dashboard (telemetry + manual control)


