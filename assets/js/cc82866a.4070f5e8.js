"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3770],{34035:(s,e,a)=>{a.r(e),a.d(e,{assets:()=>m,contentTitle:()=>h,default:()=>x,frontMatter:()=>c,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"lab/03/index","title":"03 - PWM & ADC","description":"Pulse Width Modulation and Analog to Digital Converters","source":"@site/versioned_docs/version-fils_en/lab/03/index.mdx","sourceDirName":"lab/03","slug":"/lab/03","permalink":"/docs/fils_en/lab/03","draft":false,"unlisted":false,"editUrl":"https://www.github.com/upb-pmrust/website/edit/main/website/lab/03/index.mdx","tags":[],"version":"fils_en","frontMatter":{"description":"Pulse Width Modulation and Analog to Digital Converters","slug":"/lab/03"},"sidebar":"tutorialSidebar","previous":{"title":"02 - GPIO","permalink":"/docs/fils_en/lab/02"},"next":{"title":"04 - Asynchronous Development","permalink":"/docs/fils_en/lab/04"}}');var i=a(74848),l=a(28453),t=a(11470),r=a(19365);const c={description:"Pulse Width Modulation and Analog to Digital Converters",slug:"/lab/03"},h="03 - PWM & ADC",m={},d=[{value:"Concepts",id:"concepts",level:2},{value:"Resources",id:"resources",level:2},{value:"Timing",id:"timing",level:2},{value:"Clocks",id:"clocks",level:3},{value:"Counters",id:"counters",level:3},{value:"SysTick",id:"systick",level:4},{value:"Timers",id:"timers",level:3},{value:"Analog and Digital Signals",id:"analog-and-digital-signals",level:2},{value:"Pulse-Width Modulation (PWM)",id:"pulse-width-modulation-pwm",level:2},{value:"Examples of hardware controlled through PWM",id:"examples-of-hardware-controlled-through-pwm",level:3},{value:"How to wire an RGB LED",id:"how-to-wire-an-rgb-led",level:4},{value:"How to wire a servo motor",id:"how-to-wire-a-servo-motor",level:4},{value:"PWM in Embassy-rs",id:"pwm-in-embassy-rs",level:3},{value:"Controlling a Servo Motor Using PWM",id:"controlling-a-servo-motor-using-pwm",level:3},{value:"Calculating the TOP Value",id:"calculating-the-top-value",level:4},{value:"Analog-to-Digital Converter (ADC)",id:"analog-to-digital-converter-adc",level:2},{value:"Nyquist-Shannon Sampling Theorem",id:"nyquist-shannon-sampling-theorem",level:3},{value:"Examples of analog sensors",id:"examples-of-analog-sensors",level:3},{value:"How to wire a photoresistor",id:"how-to-wire-a-photoresistor",level:4},{value:"ADC in Embassy-rs",id:"adc-in-embassy-rs",level:3},{value:"Exercises",id:"exercises",level:2}];function o(s){const e={a:"a",admonition:"admonition",annotation:"annotation",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",math:"math",mdxAdmonitionTitle:"mdxAdmonitionTitle",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",mstyle:"mstyle",msub:"msub",mtable:"mtable",mtd:"mtd",mtext:"mtext",mtr:"mtr",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...s.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"03---pwm--adc",children:"03 - PWM & ADC"})}),"\n",(0,i.jsx)(e.p,{children:"The purpose of this lab is to help you learn about different types of signals in electronics and how to work with them."}),"\n","\n",(0,i.jsx)(e.h2,{id:"concepts",children:"Concepts"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Understanding digital vs. analog signals;"}),"\n",(0,i.jsx)(e.li,{children:"Simulating analog signals using Pulse Width Modulation (PWM);"}),"\n",(0,i.jsx)(e.li,{children:"Converting analog signals to digital using Analog-to-Digital Converters (ADC);"}),"\n",(0,i.jsx)(e.li,{children:"Practical applications of PWM and ADC in circuit design."}),"\n",(0,i.jsx)(e.li,{children:"How to use the lab board's components."}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"resources",children:"Resources"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"STMicroelectronics"}),", ",(0,i.jsx)(e.em,{children:(0,i.jsx)(e.a,{href:"https://www.st.com/resource/en/datasheet/stm32u545ce.pdf",children:"STM32U545 Datasheet"})})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"STMicroelectronics"}),", ",(0,i.jsx)(e.em,{children:(0,i.jsx)(e.a,{href:"https://www.st.com/resource/en/user_manual/um3062-stm32u3u5-nucleo64-boards-mb1841-stmicroelectronics.pdf",children:"Nucleo STM32U545 User manual"})})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Raspberry Pi Ltd"}),", ",(0,i.jsx)(e.em,{children:(0,i.jsx)(e.a,{href:"https://datasheets.raspberrypi.com/rp2350/rp2350-datasheet.pdf",children:"RP2350 Datasheet"})})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Chapter 8 - ",(0,i.jsx)(e.em,{children:"Clocks"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Subchapter 8.1.1"}),"\n",(0,i.jsx)(e.li,{children:"Subchapter 8.1.2"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["Chapter 12 - ",(0,i.jsx)(e.em,{children:"Peripherals"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Chapter 12.4 - ",(0,i.jsx)(e.em,{children:"ADC and Temperature Sensor"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Subchapter 12.4.1"}),"\n",(0,i.jsx)(e.li,{children:"Subchapter 12.4.3"}),"\n",(0,i.jsx)(e.li,{children:"Subchapter 12.4.6"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["Chapter 12.5 - ",(0,i.jsx)(e.em,{children:"PWM"})]}),"\n",(0,i.jsxs)(e.li,{children:["Chapter 12.8 - ",(0,i.jsx)(e.em,{children:"System Timers"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Paul Denisowski"}),", ",(0,i.jsx)(e.em,{children:(0,i.jsx)(e.a,{href:"https://www.youtube.com/watch?v=nXFoVSN3u-E",children:"Understanding PWM"})})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"timing",children:"Timing"}),"\n",(0,i.jsx)(e.p,{children:"In embedded applications, keeping track of time is crucial. Even for the simple task of blinking an LED at a certain time interval, we need a reference of time that is constant and precise."}),"\n",(0,i.jsx)(e.h3,{id:"clocks",children:"Clocks"}),"\n",(0,i.jsx)(e.p,{children:"A clock is a piece of hardware that provides us with that reference. Its purpose is to oscillate at a fixed frequency and provide a signal that switches from high to low at a fixed interval."}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"ClockSignal",src:a(63946).A+"",width:"785",height:"228"})}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsxs)(r.A,{value:"stm32u5",label:"STM32 Nucleo-U545RE-Q",default:!0,children:[(0,i.jsxs)(e.p,{children:["The most precise type of clock on the STM32 Nucleo-U545RE-Q is the ",(0,i.jsx)(e.em,{children:"High-Speed External oscillator (HSE)"}),". The reason why it is so accurate is because it uses the crystal\u2019s natural vibration frequency to generate the clock signal. This oscillator is usually external to the microcontroller itself, requiring a crystal or external clock source connected to the HSE pins."]}),(0,i.jsxs)(e.p,{children:["The processor also provides several ",(0,i.jsx)(e.em,{children:"internal RC oscillators"})," (HSI, MSI, LSI), which are less accurate because they rely on resistor-capacitor timing rather than quartz resonance. These internal clocks are useful when small variations in clock pulses are acceptable, or when minimizing external components is important."]}),(0,i.jsx)(e.p,{children:"The STM32 Nucleo-U545RE-Q does not have a built-in crystal frequency. Instead, the board designer selects an appropriate crystal (commonly 8\u202fMHz, 16\u202fMHz, or 24\u202fMHz) to drive the HSE, depending on the application requirements."}),(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"High-Speed External oscillator (HSE)",src:a(59463).A+"",width:"790",height:"697"})})]}),(0,i.jsxs)(r.A,{value:"rp2350",label:"Raspberry Pi Pico/Raspberry Pi Pico 2",default:!0,children:[(0,i.jsx)(e.p,{children:"The most precise type of clock is the crystal oscillator (XOSC). The reason why it is so accurate is because it uses the crystal's natural vibration frequency to create the clock signal. This clock is usually external to the processor itself, but the processor also has an internal clock (ROSC) that is less accurate and that can be used in cases where small variations of clock pulses are negligible. When using the USB protocol, for instance, a more stable clock signal is required, therefore the XOSC is necessary. The crystal oscillator on the Raspberry Pi Pico board has a frequency of 12MHz."}),(0,i.jsx)(e.p,{children:"This clock signal is just a reference, and most of the time we need to adjust it to our needs. This is done by either multiplying or dividing the clock, or in other words, elevating or lowering the frequency of the clock. For example, the RP2040 itself runs on a 133MHz clock, so the crystal oscillator frequency of 12MHz is multiplied (this is done using a method called Phase-Locked Loop). Similarly, the RP2350, the successor to the RP2040, also uses a PLL to adjust the 12MHz reference clock but supports a higher clock speed of 150MHz. This increased clock speed, along with more precise frequency control and improved power management, makes the RP2350 more versatile for both high-performance and energy-efficient applications."}),(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"RPCrystal",src:a(9450).A+"",width:"591",height:"371"})})]})]}),"\n",(0,i.jsx)(e.h3,{id:"counters",children:"Counters"}),"\n",(0,i.jsx)(e.p,{children:'A counter in electronics is a tool that tracks numbers, typically by adding or subtracting one each time the clock ticks. When it reaches its maximum (or minimum) value, it resets or wraps around. This reset is called an "overflow" (when counting up) or "underflow" (when counting down). Some counters can also switch between counting up and down based on control signals.'}),"\n",(0,i.jsx)(e.admonition,{type:"info",children:(0,i.jsx)(e.p,{children:"A regular counter on 8 bits would count up from 0 to 255, then loop back to 0 and continue counting."})}),"\n",(0,i.jsx)(e.p,{children:"In theory a counter is associated with 3 registers:"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"Register"}),(0,i.jsx)(e.th,{children:"Description"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"value"})}),(0,i.jsx)(e.td,{children:"the current value of the counter"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"direction"})}),(0,i.jsx)(e.td,{children:"whether the counter is counting UP or DOWN"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"reset"})}),(0,i.jsx)(e.td,{children:"if the direction is UP, the value at which the counter resets to 0; if the direction is DOWN, the value at which the counter reset after reaching 0"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Counter",src:a(13728).A+"",width:"381",height:"294"})}),"\n",(0,i.jsx)(e.p,{children:"The way the counter works here is that it increments/decrements every clock cycle and checks whether or not it has reached its reset value. If is has, then it resets to its initial value and starts all over again."}),"\n",(0,i.jsx)(e.h4,{id:"systick",children:"SysTick"}),"\n",(0,i.jsx)(e.p,{children:"The ARM Cortex\u2011M0+ used by the RP2040, the ARM Cortex\u2011M33 used by the RP2350, and the ARM Cortex\u2011M33 used by the STM32U545 all provide the SysTick time counter to keep track of time. This counter automatically decrements, and when it reaches 0, it triggers an exception and then resets to the reload value."}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"SYST_CVR"})," register - the value of the timer itself"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"SYST_RVR"})," register - the reset value"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"SYST_CSR_SET"})," register:","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ENABLE"})," field - enable/disable the counter"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"TICKINT"})," field - enable/disable exception on reaching 0"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Difference:"})}),"\n",(0,i.jsx)(e.p,{children:"On the RP2040, documentation often describes the counter as decrementing \u201cevery microsecond,\u201d since it is usually configured that way. On the RP2350 and STM32U5, the counter instead decrements on every processor clock cycle (or external reference clock), so to get a 1\u202f\xb5s or 1\u202fms tick you must calculate the reload value based on the actual system clock frequency."}),"\n",(0,i.jsx)(e.h3,{id:"timers",children:"Timers"}),"\n",(0,i.jsxs)(e.p,{children:["The simplest way to make a processor wait is to ask the processor to skip a clock cycle a number of times, or by calling the processor instruction ",(0,i.jsx)(e.code,{children:"nop"})," (no operation) in a loop."]}),"\n",(0,i.jsx)(e.admonition,{type:"info",children:(0,i.jsxs)(e.p,{children:["This method is not ideal, since the ",(0,i.jsx)(e.code,{children:"nop"})," instruction stalls the processor and wastes valuable time that could otherwise be used to do other things in the meantime. To optimize this, we can use ",(0,i.jsx)(e.em,{children:"alarms"}),"."]})}),"\n",(0,i.jsxs)(e.p,{children:["An ",(0,i.jsx)(e.strong,{children:"alarm"})," is a counter that triggers an interrupt every time it reaches a certain value. This way, an alarm can be set to trigger after a specific interval of time, and while the ",(0,i.jsx)(e.strong,{children:"alarm"})," hardware is ",(0,i.jsx)(e.em,{children:"running in the background"}),", the main program can continue executing instructions, and so it is not blocked. When the alarm reaches the chosen value, it goes off and triggers an interrupt that can then be handled in its specific Interrupt Service Routine (ISR)."]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Alarm",src:a(43755).A+"",width:"558",height:"469"})}),"\n",(0,i.jsxs)(e.admonition,{type:"info",children:[(0,i.jsxs)(e.p,{children:["The ",(0,i.jsx)(e.strong,{children:"RP2350"})," timer and the ",(0,i.jsx)(e.strong,{children:"RP2040's"})," are fully monotonic, meaning they can never truly overflow. Their value is stored on 64 bits and incremented every 1 microsecond, ensuring precise and consistent timekeeping. This means the last value they can increment to before overflowing is 2",(0,i.jsx)("sup",{children:"64"}),"\u20111, which is equivalent to roughly 500,000 years. RP2040 and RP2350 support 4 different alarms (TIMERx_IRQ_0/1/2/3), which can be used independently, allowing for multiple timed events or tasks to be managed simultaneously."]}),(0,i.jsxs)(e.p,{children:["The ",(0,i.jsx)(e.strong,{children:"RP2350"})," provides two timer peripherals, while the ",(0,i.jsx)(e.strong,{children:"RP2040"})," provides only one."]}),(0,i.jsxs)(e.p,{children:["The ",(0,i.jsx)(e.strong,{children:"STM32U5"}),", by contrast, does not use a single 64\u2011bit monotonic timer. Instead, it provides a set of general\u2011purpose 16\u2011bit and 32\u2011bit timers (TIMx) as well as advanced timers for motor control and low\u2011power timers for energy\u2011sensitive applications. These timers can be configured with prescalers and auto\u2011reload registers to generate periodic interrupts, PWM signals, input capture, or output compare events. Unlike the RP2040 and RP2350\u2019s unified 64\u2011bit microsecond counter, STM32 timers can overflow depending on their bit\u2011width (e.g., a 16\u2011bit timer rolls over after 65,535 counts). To achieve long\u2011duration or monotonic timekeeping, software typically chains timers or uses the SysTick timer in combination with interrupts."]})]}),"\n",(0,i.jsx)(e.h2,{id:"analog-and-digital-signals",children:"Analog and Digital Signals"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Analog signals"})," are a representation of real-world data. They communicate information in a continuous function of time. They are smooth and time-varying waves, and contain an infinite number of values within the continuous range. An example of an analog signal would be sound, or the human voice."]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"AnalogSignal",src:a(73640).A+"",width:"1085",height:"372"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Digital signals"})," are a discrete representation of data. They are represented by a sequence of binary values, taken from a finite set of possible numbers. They are square and discrete waves. In most cases, they are represented by two values: 0 and 1 (or 0V and 5V). Digital representation of signals is usually used in hardware."]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"DigitalSignal",src:a(54744).A+"",width:"1067",height:"396"})}),"\n",(0,i.jsx)(e.h2,{id:"pulse-width-modulation-pwm",children:"Pulse-Width Modulation (PWM)"}),"\n",(0,i.jsxs)(e.p,{children:["Up to now, we learned to turn an LED on and off, or in other words, set a LED's intensity to 100% or 0%. What if we wanted to turn on the LED only at 50% intensity? We only have a two-level digital value, 0 or 1, so technically a value of 0.5 is not possible. What we can do is simulate this analog signal, so that it ",(0,i.jsx)(e.em,{children:"looks"})," like the LED is at half intensity."]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Pulse-Width Modulation"})," is a method of simulating an analog signal using a digital one, by varying the width of the generated square wave."]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"PWMExample",src:a(67718).A+"",width:"731",height:"219"})}),"\n",(0,i.jsx)(e.admonition,{type:"note",children:(0,i.jsx)(e.p,{children:"We can think of the simulated analog signal being directly proportional to the change in digital signal pulse size. The larger the square wave at a given period T, the higher the average analog amplitude output for that period."})}),"\n",(0,i.jsxs)(e.p,{children:["The ",(0,i.jsx)(e.strong,{children:"duty cycle"})," of the signal is the percentage of time per period that the signal is high."]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"DutyCycle",src:a(80820).A+"",width:"494",height:"259"})}),"\n",(0,i.jsx)(e.p,{children:"So if we wanted our led to be at 50% intensity, we would choose a duty cycle of 50%. By quickly switching between high and low, the led appears to the human eye as being at only 50% intensity, when in reality, it's only on at max intensity 50% of the time, and off the rest of the time."}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"PWMLed",src:a(70066).A+"",width:"440",height:"200"})}),"\n",(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"d"}),(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{children:"y"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"_"}),(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"y"}),(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"m"}),(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"_"}),(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsx)(e.mi,{children:"n"})]}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsx)(e.mi,{children:"r"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsx)(e.mi,{children:"d"})]})]}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"%"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\nduty\\_cycle = \\frac{time\\_on}{period} \\%\n"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.0044em",verticalAlign:"-0.31em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,i.jsx)(e.span,{className:"mord",style:{marginRight:"0.02778em"},children:"_"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"cyc"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"2.24em",verticalAlign:"-0.8804em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.3595em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"er"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"o"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"d"})]})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.7em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"im"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"mord",style:{marginRight:"0.02778em"},children:"_"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"o"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"n"})]})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.8804em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mord",children:"%"})]})]})]})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.em,{children:"Counters"})," are used by the STM32U5, the RP2350, and the RP2040  to generate PWM signals. On the RP2040 and RP2350, the PWM counters are controlled by channel registers (X can be from 0\u20137, depending on the channel). On the STM32U545, PWM generation is handled by the timer peripherals (",(0,i.jsx)(e.code,{children:"TIMx"}),"), where each channel uses a counter (",(0,i.jsx)(e.code,{children:"TIMx_CNT"}),"), a compare register (",(0,i.jsx)(e.code,{children:"TIMx_CCRy"}),"), and an auto\u2011reload register (",(0,i.jsx)(e.code,{children:"TIMx_ARR"}),") to define the duty cycle and period."]}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsxs)(r.A,{value:"stm32u5",label:"STM32 Nucleo-U545RE-Q",default:!0,children:[(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"TIMx_CNT"})," - the actual value of the counter"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"TIMx_CCRy"})," - the compare value for channel y (this sets the duty cycle)"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"TIMx_ARR"})," - the auto\u2011reload value, the maximum count before the counter resets (this sets the period)"]}),"\n"]}),(0,i.jsxs)(e.p,{children:["When ",(0,i.jsx)(e.code,{children:"TIMx_CNT"})," is reset (0), the output signal is set to 1 (active). The counter counts up until it reaches ",(0,i.jsx)(e.code,{children:"TIMx_CCRy"}),", after which the output signal becomes 0 (inactive). The counter continues to count until it reaches ",(0,i.jsx)(e.code,{children:"TIMx_ARR"}),", then it resets to 0 and the signal becomes 1 again."]})]}),(0,i.jsxs)(r.A,{value:"rp2350",label:"Raspberry Pi Pico 1 / 2",default:!0,children:[(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"CHX_CTR"})," - the actual value of the counter"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"CHX_CC"})," - the value that the counter will compare to"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"CHX_TOP"})," - the value at which the counter will reset (or ",(0,i.jsx)(e.em,{children:"wrap"}),")"]}),"\n"]}),(0,i.jsxs)(e.p,{children:["When ",(0,i.jsx)(e.code,{children:"CHX_CTR"})," is reset, the value of the output signal is 1. The counter counts up until it reaches ",(0,i.jsx)(e.code,{children:"CHX_CC"}),", after which the value of the output signal becomes 0. The counter continues to count until it reaches ",(0,i.jsx)(e.code,{children:"CHX_TOP"}),", and then the signal becomes 1 again. This way, by choosing the value of ",(0,i.jsx)(e.code,{children:"CHX_CC"}),", we set the duty cycle of the PWM signal."]})]})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"PWMRP2040",src:a(7855).A+"",width:"1502",height:"960"})}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsxs)(r.A,{value:"stm32u5",label:"STM32 Nucleo-U545RE-Q",default:!0,children:[(0,i.jsx)(e.p,{children:"On STM32U5, PWM signals are generated by the timer peripherals (TIMx). Each timer provides multiple channels, and each channel can be mapped to specific GPIO pins through the alternate function system."}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"Arduino connector"}),(0,i.jsx)(e.th,{children:"STM32 pin"}),(0,i.jsx)(e.th,{children:"PWMs"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"D3"})}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"PB3"})}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"TIM2_CH2"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"D5"})}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"PB4"})}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"TIM3_CH1"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"D6"})}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"PB10"})}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"TIM2_CH3"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"D9"})}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"PC6"})}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"TIM3_CH1"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"D11"})}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"PA7"})}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"TIM3_CH2"})})]})]})]}),(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"STM32U5PWMPins",src:a(22258).A+"",width:"1404",height:"500"})}),(0,i.jsx)(e.admonition,{type:"info",children:(0,i.jsxs)(e.p,{children:["You can find more details about the pins in the ",(0,i.jsx)(e.a,{href:"https://www.st.com/resource/en/user_manual/um3062-stm32u3u5-nucleo64-boards-mb1841-stmicroelectronics.pdf",children:"user manual"})," of the board(page 33)"]})})]}),(0,i.jsxs)(r.A,{value:"rp2350",label:"Raspberry Pi Pico 1 / 2",default:!0,children:[(0,i.jsx)(e.p,{children:"On RP2350 and RP2040, all GPIO pins support PWM. Every two pins share a PWM slice, and each one of them is on a separate channel."}),(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"RP2040PWMPins",src:a(51257).A+"",width:"1902",height:"361"})}),(0,i.jsx)(e.admonition,{type:"info",children:(0,i.jsx)(e.p,{children:"This means that in order to use a pin as PWM, we need to know what channel it's on, and which output it uses (A or B)."})})]})]}),"\n",(0,i.jsx)(e.h3,{id:"examples-of-hardware-controlled-through-pwm",children:"Examples of hardware controlled through PWM"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"leds"}),"\n",(0,i.jsx)(e.li,{children:"motors"}),"\n",(0,i.jsx)(e.li,{children:"buzzers"}),"\n",(0,i.jsx)(e.li,{children:"RGB leds (what we will be using for this lab)"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["An ",(0,i.jsx)(e.strong,{children:"RGB"})," LED is a led that can emit any color, using a combination of red, green and blue light. On the inside, it's actually made up of 3 separate leds:"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.em,{children:"R"})," led - to control the intensity of the ",(0,i.jsx)(e.em,{children:"red"})," light"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.em,{children:"G"})," led - to control the intensity of the ",(0,i.jsx)(e.em,{children:"green"})," light"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.em,{children:"B"})," led - to control the intensity of the ",(0,i.jsx)(e.em,{children:"blue"})," light"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"By using PWM on the R, G and B leds, we can control each of their intensity to represent any color."}),"\n",(0,i.jsx)(e.admonition,{type:"info",children:(0,i.jsx)(e.p,{children:"For example, if we wanted to create the color purple, we would set the intensity of red and blue to 100%, and the intensity of green to 0%."})}),"\n",(0,i.jsx)(e.p,{children:"There are two different types of RGB LEDs:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"common cathode: all LED cathodes are connected together. A LOW signal means off, and a HIGH signal means on at max intensity."}),"\n",(0,i.jsx)(e.li,{children:"common anode: all LED anodes are connected together. A LOW signal means on at max intensity, and a HIGH signal means off."}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"CommonAnodeCommonCathode",src:a(62621).A+"",width:"1000",height:"569"})}),"\n",(0,i.jsx)(e.admonition,{type:"warning",children:(0,i.jsxs)(e.p,{children:["For this lab, we will be using ",(0,i.jsx)(e.strong,{children:"common anode"})," RGB LEDs, which means that the PWM signal should be ",(0,i.jsx)(e.em,{children:"opposite"}),". 0 will be 100% intensity, and 1 will be 0% intensity."]})}),"\n",(0,i.jsx)(e.h4,{id:"how-to-wire-an-rgb-led",children:"How to wire an RGB LED"}),"\n",(0,i.jsxs)(e.p,{children:["The RGB LED that the board provides is signaled with labels ",(0,i.jsx)(e.code,{children:"RGB_B"})," (blue), ",(0,i.jsx)(e.code,{children:"RGB_G"})," (green) and ",(0,i.jsx)(e.code,{children:"RGB_R"})," (red) in the connectors section."]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"RGBWiring",src:a(87559).A+"",width:"1133",height:"493"})}),"\n",(0,i.jsx)(e.h4,{id:"how-to-wire-a-servo-motor",children:"How to wire a servo motor"}),"\n",(0,i.jsxs)(e.p,{children:["A ",(0,i.jsx)(e.strong,{children:"servo motor"})," is a motor that can be controlled with PWM. It has an arm that can be rotated to a specific angle, depending on the PWM signal it receives."]}),"\n",(0,i.jsx)(e.p,{children:"A servo motor has three wires:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Power"})," - usually red, connected to a voltage source (5V)"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Ground"})," - usually black, connected to the ground"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Signal"})," - usually orange, connected to a PWM pin\n",(0,i.jsx)(e.img,{alt:"ServoMotorWiring",src:a(82087).A+"",width:"638",height:"493"})]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["The board provides the connectors for the servo motor. These connectors are labeled ",(0,i.jsx)(e.code,{children:"GND"}),", ",(0,i.jsx)(e.code,{children:"PWR"}),", and ",(0,i.jsx)(e.code,{children:"SIG"})," in the connectors section."]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"ServoMotor",src:a(37089).A+"",width:"1019",height:"617"})}),"\n",(0,i.jsxs)(e.p,{children:["To wire the servo motor to the STM32 Nucleo-U545RE-Q, note that the servo\u2019s ",(0,i.jsx)(e.code,{children:"PWR"}),", ",(0,i.jsx)(e.code,{children:"GND"}),", and ",(0,i.jsx)(e.code,{children:"SIG"})," lines are already connected to the lab board. The only additional step is to place a jumper wire from the SIG connector of the the lab board to a suitable PWM-capable pin on the STM32 Nucleo-U545RE-Q."]}),"\n",(0,i.jsx)(e.h3,{id:"pwm-in-embassy-rs",children:"PWM in Embassy-rs"}),"\n",(0,i.jsx)(e.p,{children:"First, we need a reference to all peripherals, as usual."}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsxs)(r.A,{value:"stm32u5",label:"STM32 Nucleo-U545RE-Q",default:!0,children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"// Initialize peripherals\nlet peripherals = embassy_stm32::init(Default::default());\n"})}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"use embassy_stm32::timer::simple_pwm::{PwmPin, SimplePwm};\nuse embassy_stm32::peripherals::TIM2;\nuse embassy_stm32::timer::Ch1;\n\n    // Configure PA0 as TIM2_CH1 PWM output\n    let led_pwm_pin: PwmPin<'_, TIM2, Ch1> = PwmPin::new(p.PA0, OutputType::PushPull);\n"})}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"PA0"})," \u2192 the physical GPIO pin you want to use."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"TIM2"})," \u2192 the timer peripheral that will generate the PWM signal."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Ch1"})," \u2192 the channel of that timer (channel 1)."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"PwmPin::new_ch1"})," \u2192 ties PA0 to TIM2 channel 1\u2019s output."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"OutputType::PushPull"})," \u2192 configures the electrical drive mode of the pin."]}),"\n"]}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"let mut pwm = SimplePwm::new(\n    p.TIM2,              // Timer 2 peripheral\n    Some(led_pwm_pin),   // Channel 1 output (PA0)\n    None,                // Channel 2 not used\n    None,                // Channel 3 not used\n    None,                // Channel 4 not used\n    khz(1),              // PWM frequency = 1 kHz\n    Default::default(),  // Default configuration\n);\n"})}),(0,i.jsx)(e.admonition,{type:"warning",children:(0,i.jsx)(e.p,{children:"The code above is an example for PA0 with TIM2_CH1. You need to modify the timer, channel, and pin depending on which PWM\u2011capable pin you want to use!"})}),(0,i.jsx)(e.p,{children:"If we decide to modify the duty cycle of the PWM, we can update it directly on the channel:"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"let mut ch1 = pwm.ch1(); // Get handle for channel 1\nch1.enable();\n\n// Set duty cycle to 50%\nch1.set_duty_cycle_percent(50);\n\n// Later, change duty cycle to 10%\nch1.set_duty_cycle_percent(10);\n"})})]}),(0,i.jsxs)(r.A,{value:"rp2350",label:"Raspberry Pi Pico 1 / 2",default:!0,children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"// Initialize peripherals\nlet peripherals = embassy_rp::init(Default::default());\n"})}),(0,i.jsxs)(e.p,{children:["In order to modify the PWM counter configurations, we need to create a ",(0,i.jsx)(e.code,{children:"Config"})," for our PWM."]}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"// PWM config\nuse embassy_rp::pwm::Config as ConfigPwm; \n\n// Create config for PWM slice\nlet mut config: ConfigPwm = Default::default();\n// Set top value (value at which PWM counter will reset)\nconfig.top = 0x9088; // in HEX, equals 37000 in decimal\n// Set compare value (counter value at which the \n// PWM signal will change from 1 to 0)\nconfig.compare_a = config.top / 2;\n"})}),(0,i.jsx)(e.p,{children:"In the example above:"}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"top"})," is the field from ",(0,i.jsx)(e.code,{children:"Config"})," that will define the value at which the counter will reset back to 0"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"compare_a"})," is the field from ",(0,i.jsx)(e.code,{children:"Config"})," that will define the value at which the PWM signal will switch from 1 to 0\nIn this case, ",(0,i.jsx)(e.code,{children:"config.compare_a"})," is half of ",(0,i.jsx)(e.code,{children:"config.top"}),". This means that the duty cycle of the generated PWM signal will be 50%, or, in other words, that the PWM signal will switch from 1 to 0 halfway through each period."]}),"\n"]}),(0,i.jsx)(e.p,{children:"To select the pin that we want to use for PWM, we need to create a new PWM driver that uses the correct channel and output for our pin."}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"// Create a PWM driver for pin 3\nlet mut pwm = Pwm::new_output_b( // Output B\n    peripherals.PWM_SLICE1, // Channel 1\n    peripherals.PIN_3,   // Pin 3 (modify this as needed)\n    config.clone()\n);\n"})}),(0,i.jsx)(e.admonition,{type:"warning",children:(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"The code above is an example for pin 3. You need to modify the channel, output and pin depending on the PWM pin you choose to use!"}),"\n",(0,i.jsxs)(e.li,{children:["The value of ",(0,i.jsx)(e.code,{children:"compare_a"})," or ",(0,i.jsx)(e.code,{children:"compare_b"})," must be changed depending on the desired duty cycle!"]}),"\n"]})}),(0,i.jsxs)(e.p,{children:["If we decide to modify the value of ",(0,i.jsx)(e.code,{children:"compare_a"})," or ",(0,i.jsx)(e.code,{children:"compare_b"}),", we have to update the configuration for the PWM."]}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"config.compare_b += 100; // modified value of `compare_b`\npwm.set_config(&config); // set the new configuration for PWM\n"})})]})]}),"\n",(0,i.jsx)(e.h3,{id:"controlling-a-servo-motor-using-pwm",children:"Controlling a Servo Motor Using PWM"}),"\n",(0,i.jsx)(e.p,{children:"Just like controlling other hardware through PWM, we start by initializing the peripherals."}),"\n",(0,i.jsx)(e.p,{children:"Servos typically expect a 50 Hz PWM signal, which corresponds to a 20 ms period."}),"\n",(0,i.jsx)(e.p,{children:"Servos interpret PWM signals based on the pulse width rather than just frequency:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Period"}),": The total time for one PWM cycle, which is 20 ms (50 Hz)."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Minimum Pulse Width"}),": Typically ",(0,i.jsx)(e.strong,{children:"0.5 ms"}),", which corresponds to a servo position of ",(0,i.jsx)(e.strong,{children:"0 degrees"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"Maximum Pulse Width"}),": Typically ",(0,i.jsx)(e.strong,{children:"2.5 ms"}),", which corresponds to a servo position of ",(0,i.jsx)(e.strong,{children:"180 degrees"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsxs)(r.A,{value:"stm32u5",label:"STM32 Nucleo-U545RE-Q",default:!0,children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"// Initialize peripherals\nlet peripherals = embassy_stm32::init(Default::default());\n"})}),(0,i.jsx)(e.p,{children:"At 50\u202fHz, the PWM period is:"}),(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"T"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mn,{children:"20"}),(0,i.jsx)(e.mi,{children:"m"}),(0,i.jsx)(e.mi,{children:"s"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\nT = 20ms \n"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"T"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"20"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"m"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"s"})]})]})]})}),(0,i.jsxs)(e.p,{children:["For a given pulse width ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"w"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"d"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{children:"h"})]})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"pulse_{width}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"s"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02691em"},children:"w"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"d"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"h"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," the duty cycle percentage is:"]}),(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"d"}),(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"y"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"y"}),(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"e"})]})]}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{fence:"true",children:"("}),(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"w"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"d"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{children:"h"})]})]}),(0,i.jsx)(e.mo,{children:"\xd7"}),(0,i.jsx)(e.mn,{children:"100"})]}),(0,i.jsx)(e.mi,{children:"T"})]}),(0,i.jsx)(e.mo,{fence:"true",children:")"})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\nduty_{cycle} = \\left( \\frac{pulse_{width} \\times 100}{T} \\right)\n"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.9805em",verticalAlign:"-0.2861em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"cyc"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"e"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"2.4em",verticalAlign:"-0.95em"}}),(0,i.jsxs)(e.span,{className:"minner",children:[(0,i.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:"("})}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.3714em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"T"})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"s"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02691em"},children:"w"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"d"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"h"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mord",children:"100"})]})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:")"})})]})]})]})]})}),(0,i.jsxs)(e.p,{children:["The function ",(0,i.jsx)(e.code,{children:"set_duty_cycle_fraction(num, den)"})," expects a fraction representing the duty cycle."]}),(0,i.jsxs)(e.p,{children:["For example, to generate a ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"w"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"d"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{children:"h"})]})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"pulse_{width}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"s"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02691em"},children:"w"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"d"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"h"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," of 2.5ms,"]}),(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"d"}),(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"y"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"y"}),(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"e"})]})]}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{fence:"true",children:"("}),(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mn,{children:"2.5"}),(0,i.jsx)(e.mo,{children:"\xd7"}),(0,i.jsx)(e.mn,{children:"1000"})]}),(0,i.jsx)(e.mn,{children:"20"})]}),(0,i.jsx)(e.mo,{fence:"true",children:")"})]}),(0,i.jsx)(e.mtext,{children:"\u2030"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mn,{children:"125"}),(0,i.jsx)(e.mtext,{children:"\u2030"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\nduty_{cycle} = \\left( \\frac{2.5 \\times 1000}{20} \\right) \u2030 = 125 \u2030\n"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.9805em",verticalAlign:"-0.2861em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"cyc"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"e"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"2.4em",verticalAlign:"-0.95em"}}),(0,i.jsxs)(e.span,{className:"minner",children:[(0,i.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:"("})}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.3214em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsx)(e.span,{className:"mord",children:"20"})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord",children:"2.5"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mord",children:"1000"})]})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:")"})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\u2030"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"125\u2030"})]})]})]})}),(0,i.jsxs)(e.p,{children:["That means ",(0,i.jsx)(e.code,{children:"set_duty_cycle_fraction(125, 1000)"})]}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["For ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"w"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"d"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{children:"h"})]})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"pulse_{width}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"s"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02691em"},children:"w"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"d"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"h"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," = 0.5ms:"]}),"\n"]}),(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"d"}),(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"y"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"y"}),(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"e"})]})]}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{fence:"true",children:"("}),(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mn,{children:"0.5"}),(0,i.jsx)(e.mo,{children:"\xd7"}),(0,i.jsx)(e.mn,{children:"1000"})]}),(0,i.jsx)(e.mn,{children:"20"})]}),(0,i.jsx)(e.mo,{fence:"true",children:")"})]}),(0,i.jsx)(e.mtext,{children:"\u2030"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mn,{children:"25"}),(0,i.jsx)(e.mtext,{children:"\u2030"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\nduty_{cycle} = \\left( \\frac{0.5 \\times 1000}{20} \\right) \u2030 = 25 \u2030\n"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.9805em",verticalAlign:"-0.2861em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"cyc"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"e"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"2.4em",verticalAlign:"-0.95em"}}),(0,i.jsxs)(e.span,{className:"minner",children:[(0,i.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:"("})}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.3214em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsx)(e.span,{className:"mord",children:"20"})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord",children:"0.5"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mord",children:"1000"})]})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:")"})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\u2030"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"25\u2030"})]})]})]})}),(0,i.jsxs)(e.p,{children:["That means ",(0,i.jsx)(e.code,{children:"set_duty_cycle_fraction(25, 1000)"})]}),(0,i.jsx)(e.admonition,{type:"note",children:(0,i.jsx)(e.p,{children:"We use \u2030 for accuracy, as the PWM works with integer numbers and % is not accurate enough."})}),(0,i.jsx)(e.p,{children:"Now, let's implement it in Rust:"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"// Set the PWM pin\nlet servo_pin = PwmPin::new_ch1(p.PA0, OutputType::PushPull);\n\n// 50 Hz PWM (20 ms period)\nlet mut pwm = SimplePwm::new(\n    p.TIM2,\n    Some(servo_pin),\n    None,\n    None,\n    None,\n    hz(50),\n    Default::default(),\n);\n\n// Enable the PWM channel\n    let mut ch1 = pwm.ch1();\n    ch1.enable();\n\nconst MIN_PERIOD_US: u32 = 500;\nconst MAX_PERIOD_US: u32 = 2500;\nconst PERIOD_US: u32 = 20000;\n\nlet min_value = (MIN_PERIOD_US * 1000) / PERIOD_US;\nlet max_value = (MAX_PERIOD_US * 1000) / PERIOD_US;\n\n    // Main loop to move the servo back and forth\n    loop {\n        // At 50 Hz, T = 20 ms. A 2.5 ms pulse means 2.5/20 = 12.5% duty cycle.\n        set_duty_cycle_fraction(max_value as u16, 1000); // sets the servo to set servo to ~180\xb0.\n        // Wait 1 second before moving back\n        // A 0.5 ms pulse means 0.5/20 = 2.5% duty cycle.\n        set_duty_cycle_fraction(min_value as u16, 1000); // sets the servo to set servo to ~0\xb0.\n        // Wait 1 second before repeating\n    }\n"})})]}),(0,i.jsxs)(r.A,{value:"rp2350",label:"Raspberry Pi Pico 1 / 2",default:!0,children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"// Initialize peripherals\nlet peripherals = embassy_rp::init(Default::default());\n"})}),(0,i.jsxs)(e.p,{children:["To control a servo motor using PWM, we need to calculate the ",(0,i.jsx)(e.strong,{children:"TOP value"}),", which determines the PWM period."]}),(0,i.jsx)(e.h4,{id:"calculating-the-top-value",children:"Calculating the TOP Value"}),(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{fence:"true",children:"("}),(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"f"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"k"})]})]}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"f"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mi,{children:"w"}),(0,i.jsx)(e.mi,{children:"m"})]})]}),(0,i.jsx)(e.mo,{children:"\xd7"}),(0,i.jsx)(e.mi,{children:"d"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"v"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"d"}),(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsx)(e.mi,{children:"r"})]})]}),(0,i.jsx)(e.mo,{fence:"true",children:")"})]}),(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsx)(e.mn,{children:"1"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\ntop = \\left( \\frac{f_{clock}}{f_{pwm} \\times divider} \\right) - 1\n"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8095em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"o"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"2.4221em",verticalAlign:"-0.9721em"}}),(0,i.jsxs)(e.span,{className:"minner",children:[(0,i.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:"("})}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.3714em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.1076em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02691em"},children:"pw"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"m"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"er"})]})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.1076em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"c"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"oc"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03148em"},children:"k"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.9721em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:")"})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"1"})]})]})]})}),(0,i.jsx)(e.p,{children:"For example, with:"}),(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mtable,{rowspacing:"0.25em",columnalign:"right left",columnspacing:"0em",children:[(0,i.jsxs)(e.mtr,{children:[(0,i.jsx)(e.mtd,{children:(0,i.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"true",children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"f"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"k"})]})]})})}),(0,i.jsx)(e.mtd,{children:(0,i.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"true",children:(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mrow,{}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mn,{children:"150"}),(0,i.jsx)(e.mtext,{children:"\u2009"}),(0,i.jsx)(e.mi,{children:"M"}),(0,i.jsx)(e.mi,{children:"H"}),(0,i.jsx)(e.mi,{children:"z"})]})})})]}),(0,i.jsxs)(e.mtr,{children:[(0,i.jsx)(e.mtd,{children:(0,i.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"true",children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"f"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"P"}),(0,i.jsx)(e.mi,{children:"W"}),(0,i.jsx)(e.mi,{children:"M"})]})]})})}),(0,i.jsx)(e.mtd,{children:(0,i.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"true",children:(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mrow,{}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mn,{children:"50"}),(0,i.jsx)(e.mtext,{children:"\u2009"}),(0,i.jsx)(e.mi,{children:"H"}),(0,i.jsx)(e.mi,{children:"z"})]})})})]}),(0,i.jsxs)(e.mtr,{children:[(0,i.jsx)(e.mtd,{children:(0,i.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"true",children:(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"d"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"v"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"d"}),(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsx)(e.mi,{children:"r"})]})})}),(0,i.jsx)(e.mtd,{children:(0,i.jsx)(e.mstyle,{scriptlevel:"0",displaystyle:"true",children:(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mrow,{}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mn,{children:"64"})]})})})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\begin{aligned}\nf_{clock} &= 150 \\,MHz \\\\\nf_{PWM} &= 50 \\,Hz \\\\\ndivider &= 64\n\\end{aligned}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"4.5em",verticalAlign:"-2em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsxs)(e.span,{className:"mtable",children:[(0,i.jsx)(e.span,{className:"col-align-r",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"2.5em"},children:[(0,i.jsxs)(e.span,{style:{top:"-4.66em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.1076em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"c"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"oc"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03148em"},children:"k"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.16em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.1076em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"P"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"W"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10903em"},children:"M"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})})]}),(0,i.jsxs)(e.span,{style:{top:"-1.66em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"er"})]})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"2em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"col-align-l",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"2.5em"},children:[(0,i.jsxs)(e.span,{style:{top:"-4.66em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mord",children:"150"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.04398em"},children:"Hz"})]})]}),(0,i.jsxs)(e.span,{style:{top:"-3.16em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mord",children:"50"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.04398em"},children:"Hz"})]})]}),(0,i.jsxs)(e.span,{style:{top:"-1.66em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mord",children:"64"})]})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"2em"},children:(0,i.jsx)(e.span,{})})})]})})]})})]})})]})}),(0,i.jsx)(e.p,{children:"We get:"}),(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{fence:"true",children:"("}),(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mn,{children:"150"}),(0,i.jsx)(e.mtext,{children:"\u2009"}),(0,i.jsx)(e.mn,{children:"000"}),(0,i.jsx)(e.mtext,{children:"\u2009"}),(0,i.jsx)(e.mn,{children:"000"})]}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mn,{children:"50"}),(0,i.jsx)(e.mo,{children:"\xd7"}),(0,i.jsx)(e.mn,{children:"64"})]})]}),(0,i.jsx)(e.mo,{fence:"true",children:")"})]}),(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsx)(e.mn,{children:"1"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mn,{children:"46"}),(0,i.jsx)(e.mtext,{children:"\u2009"}),(0,i.jsx)(e.mn,{children:"874"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"top = \\left( \\frac{150\\,000\\,000}{50 \\times 64} \\right) - 1 = 46\\,874"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8095em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"o"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"2.4em",verticalAlign:"-0.95em"}}),(0,i.jsxs)(e.span,{className:"minner",children:[(0,i.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:"("})}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.3214em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord",children:"50"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mord",children:"64"})]})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord",children:"150"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord",children:"000"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord",children:"000"})]})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.7693em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:")"})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"1"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"46"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord",children:"874"})]})]})]})}),(0,i.jsxs)(e.p,{children:["which is ",(0,i.jsx)(e.code,{children:"0xB71A"})," in hexadecimal."]}),(0,i.jsxs)(e.p,{children:["The ",(0,i.jsx)(e.strong,{children:"clock divider"})," is used to slow down the high-frequency system clock so that it can generate a usable PWM signal. The RP2350's system clock runs at 150 MHz, which is too fast for direct PWM control of a servo. By setting the divider to 64, we effectively slow down the clock."]}),(0,i.jsx)(e.p,{children:"To convert these pulse widths into PWM compare values, we use:"}),(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsx)(e.mi,{children:"m"}),(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsx)(e.mi,{children:"r"}),(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{fence:"true",children:"("}),(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"w"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"d"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{children:"h"})]})]}),(0,i.jsx)(e.mo,{children:"\xd7"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsx)(e.mi,{children:"p"})]}),(0,i.jsx)(e.mi,{children:"T"})]}),(0,i.jsx)(e.mo,{fence:"true",children:")"})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"compare = \\left( \\frac{pulse_{width} \\times top}{T} \\right)"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"co"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"m"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"a"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"re"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"2.4em",verticalAlign:"-0.95em"}}),(0,i.jsxs)(e.span,{className:"minner",children:[(0,i.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:"("})}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.3714em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"T"})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"s"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02691em"},children:"w"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"d"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"h"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"o"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"})]})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:(0,i.jsx)(e.span,{className:"delimsizing size3",children:")"})})]})]})]})]})}),(0,i.jsx)(e.p,{children:"where:"}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"e"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"w"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"d"}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{children:"h"})]})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"pulse_{width}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"s"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02691em"},children:"w"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"d"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"h"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," is the desired pulse width in microseconds."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsx)(e.mi,{children:"p"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"top"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8095em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"o"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"p"})]})})]})," is the previously calculated counter value (46,874)."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"T"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"T"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"T"})]})})]})," is the total period in microseconds (20,000 \u03bcs for 50 Hz)."]}),"\n"]}),(0,i.jsx)(e.p,{children:"Now, let's implement this in Rust:"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"// Set the PWM pin\nlet servo_pin = PwmPin::new_ch1(p.PA0, OutputType::PushPull);\n\n// Set the calculated TOP value for 50 Hz PWM\nservo_config.top = 0xB71A; \n\n// Set the clock divider to 64\nservo_config.divider = 64_i32.to_fixed(); // Clock divider = 64\n\n// Servo timing constants\nconst PERIOD_US: usize = 20_000; // 20 ms period for 50 Hz\nconst MIN_PULSE_US: usize = 500; // 0.5 ms pulse for 0 degrees\nconst MAX_PULSE_US: usize = 2500; // 2.5 ms pulse for 180 degrees\n\n// Calculate the PWM compare values for minimum and maximum pulse widths\nlet min_pulse = (MIN_PULSE_US * servo_config.top as usize) / PERIOD_US;\nlet max_pulse = (MAX_PULSE_US * servo_config.top as usize) / PERIOD_US;\n"})}),(0,i.jsx)(e.p,{children:"After setting up the PWM configuration, we want to create a control loop that can dynamically adjust the servo's position."}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"// Initialize PWM for servo control\nlet mut servo = Pwm::new_output_a(\n    peripherals.PWM_SLICE1, \n    peripherals.PIN_2, \n    servo_config.clone()\n);\n\n// Main loop to move the servo back and forth\nloop {\n    // Move servo to maximum position (180 degrees)\n    // Set compare value for max pulse width\n    // Update PWM configuration\n    // Wait 1 second\n    // Then move the servo to minimum position (0 degrees)\n}\n"})})]})]}),"\n",(0,i.jsx)(e.h2,{id:"analog-to-digital-converter-adc",children:"Analog-to-Digital Converter (ADC)"}),"\n",(0,i.jsxs)(e.p,{children:["Now we know how to represent an analog signal using digital signals. There are plenty of cases in which we need to know how to transform an analog signal into a digital one, for example a temperature reading, or the voice of a person. This means that we need to correctly represent a continuous wave of infinite values to a discrete wave of a finite set of values.\nFor this, we need to sample the analog signal periodically, in other words to measure the analog signal at a fixed interval of time. This is done by using an ",(0,i.jsx)(e.strong,{children:"Analog-to-Digital converter"}),"."]}),"\n",(0,i.jsx)(e.p,{children:"The ADC has two important parameters that define the quality of the signal representation:"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"Parameter"}),(0,i.jsx)(e.th,{children:"Description"}),(0,i.jsx)(e.th,{children:"Impact on quality"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Sampling Rate"}),(0,i.jsx)(e.td,{children:"Frequency at which a new sample is read"}),(0,i.jsx)(e.td,{children:"The higher the sampling rate, the more samples we get, so the more accurate the representation of the signal"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Resolution"}),(0,i.jsx)(e.td,{children:"Number of bits which we can use in order to store the value of the sample"}),(0,i.jsx)(e.td,{children:"The higher the resolution, the more values we can store, so the more accurate the representation"})]})]})]}),"\n",(0,i.jsx)(e.admonition,{type:"info",children:(0,i.jsx)(e.p,{children:"For example, a resolution of 8 bits means that we can approximate the analog signal to a value from 0 to 255."})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"ADCSampling",src:a(88192).A+"",width:"587",height:"443"})}),"\n",(0,i.jsx)(e.h3,{id:"nyquist-shannon-sampling-theorem",children:"Nyquist-Shannon Sampling Theorem"}),"\n",(0,i.jsxs)(e.p,{children:["The ",(0,i.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/Nyquist%E2%80%93Shannon_sampling_theorem",children:"Nyquist-Shannon sampling theorem"})," serves as a bridge between continuous-time signals and discrete-time signals. It establishes a link between the frequency range of a signal and the sample rate required to avoid a type of distortion called ",(0,i.jsx)(e.em,{children:"aliasing"}),". Aliasing occurs when a signal is not sampled fast enough to construct an accurate waveform representation."]}),"\n",(0,i.jsx)(e.p,{children:"For an analog signal to be represented without loss of information, the conversion needs to satisfy the following formula:"}),"\n",(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"s"}),(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsx)(e.mi,{children:"m"}),(0,i.jsx)(e.mi,{children:"p"}),(0,i.jsx)(e.mi,{children:"l"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"n"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"g"}),(0,i.jsx)(e.mi,{children:"f"})]}),(0,i.jsx)(e.mo,{children:">"}),(0,i.jsx)(e.mn,{children:"2"}),(0,i.jsx)(e.mo,{children:"\xd7"}),(0,i.jsx)(e.mi,{children:"m"}),(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mi,{children:"f"})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"sampling_f > 2 \\times max_{f}"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.9805em",verticalAlign:"-0.2861em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"s"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"am"}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"pl"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"in"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10764em"},children:"f"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:">"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(e.span,{className:"mord",children:"2"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\xd7"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.7167em",verticalAlign:"-0.2861em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"ma"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10764em"},children:"f"})})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})]})]})}),"\n",(0,i.jsxs)(e.p,{children:["The analog signal needs to be sampled at a frequency greater than twice the ",(0,i.jsx)(e.em,{children:"maximum frequency"})," of the signal.\nIn other words, we must sample at least twice per cycle."]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"NyquistTheorem",src:a(22501).A+"",width:"603",height:"504"})}),"\n",(0,i.jsx)(e.h3,{id:"examples-of-analog-sensors",children:"Examples of analog sensors"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"temperature sensor"}),"\n",(0,i.jsx)(e.li,{children:"potentiometer"}),"\n",(0,i.jsx)(e.li,{children:"photoresistor"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["A ",(0,i.jsx)(e.strong,{children:"photoresistor"})," (or photocell) is a sensor that measures the intensity of light around it. Its internal resistance varies depending on the light hitting its surface; therefore, the more light there is, the lower the resistance will be."]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Photoresistor",src:a(48306).A+"",width:"266",height:"269"})}),"\n",(0,i.jsx)(e.h4,{id:"how-to-wire-a-photoresistor",children:"How to wire a photoresistor"}),"\n",(0,i.jsxs)(e.p,{children:["The photoresistor that the board provides is signaled with the label ",(0,i.jsx)(e.code,{children:"PHOTORESISTOR"})," in the connectors section."]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"PhotoresistorWiring",src:a(29563).A+"",width:"816",height:"544"})}),"\n",(0,i.jsxs)(e.admonition,{type:"info",children:[(0,i.jsxs)(e.p,{children:["To wire a photoresistor on your board at home, you need to connect one leg to ",(0,i.jsx)(e.em,{children:"GND"})," and the other leg to a voltage divider. Take a look at the ",(0,i.jsx)(e.a,{href:"/docs/fils_en/tutorial/electronics/#voltage-divider",children:"Electronics"})," tutorial:"]}),(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"V"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsx)(e.mi,{children:"t"})]})]}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"V"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"n"})]})]}),(0,i.jsx)(e.mo,{children:"\u2217"}),(0,i.jsxs)(e.mfrac,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"R"}),(0,i.jsx)(e.mn,{children:"2"})]}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"R"}),(0,i.jsx)(e.mn,{children:"1"})]}),(0,i.jsx)(e.mo,{children:"+"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"R"}),(0,i.jsx)(e.mn,{children:"2"})]})]})]}),(0,i.jsx)(e.mo,{separator:"true",children:";"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"V_{out} = V_{in} * \\frac{R_{2}}{R_{1} + R_{2}};"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"V"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2806em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.2222em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"o"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"u"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"V"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.2222em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"in"})})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u2217"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"2.1963em",verticalAlign:"-0.836em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.3603em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0077em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"1"})})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"+"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0077em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"2"})})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0077em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"2"})})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.836em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mpunct",children:";"})]})]})]})}),(0,i.jsx)(e.p,{children:"In our case:"}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"V"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"o"}),(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsx)(e.mi,{children:"t"})]})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"V_{out}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"V"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2806em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.2222em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"o"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"u"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," will be the voltage at the ADC pin on the MCU"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"V"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"n"})]})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"V_{in}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.22222em"},children:"V"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.2222em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"in"})})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," will be the voltage at the from the GPIO pin the photoresistor is tied to"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"R"}),(0,i.jsx)(e.mn,{children:"1"})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"R_{1}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0077em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"1"})})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," is the variable resistance of the photoresistor"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"R"}),(0,i.jsx)(e.mn,{children:"2"})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"R_{2}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0077em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"2"})})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," is a resistance compatible with our photoresistor (in our case, 10k ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{mathvariant:"normal",children:"\u03a9"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\Omega"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(e.span,{className:"mord",children:"\u03a9"})]})})]}),")"]}),"\n"]}),(0,i.jsx)(e.p,{children:"This way, the ADC pin measures the photoresistor's resistance, without the risk of a short-circuit."}),(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"PhotoresistorWiring",src:a(61413).A+"",width:"431",height:"285"})})]}),"\n",(0,i.jsx)(e.h3,{id:"adc-in-embassy-rs",children:"ADC in Embassy-rs"}),"\n",(0,i.jsxs)(t.A,{children:[(0,i.jsxs)(r.A,{value:"stm32u5",label:"STM32 Nucleo-U545RE-Q",default:!0,children:[(0,i.jsx)(e.p,{children:"On the STM32, the ADC peripheral does not use a FIFO interrupt like the RP2. Instead, each ADC (ADC1, ADC2, etc.) can be configured directly, and Embassy provides a driver that handles resolution, averaging, and sample time for you. All we need to do is create the ADC driver, configure it, and then bind it to the pin we want to read from."}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"// ---- fn main() ----\n\nlet p = embassy_stm32::init(Default::default());\n\n// Create ADC driver on ADCx\nlet mut adc = adc::Adc::new(p.ADCx);\n\n// Configure resolution, averaging, and sample time\nadc.set_resolution(adc::Resolution::BITS14);\nadc.set_averaging(adc::Averaging::Samples1024);\nadc.set_sample_time(adc::SampleTime::CYCLES160_5);\n\nconst MAX_VALUE: u32 = adc::resolution_to_max_count(adc::Resolution::BITS14);\n"})}),(0,i.jsxs)(e.admonition,{type:"warning",children:[(0,i.jsx)(e.mdxAdmonitionTitle,{}),(0,i.jsx)(e.p,{children:"If we are using PWM and ADC in the same code, both modules export a Config type. To avoid compilation errors, we should import them with different names:"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"use embassy_stm32::adc::Config as ConfigAdc;   // ADC config\nuse embassy_stm32::timer::simple_pwm::Config as ConfigPwm; // PWM config\n"})})]}),(0,i.jsxs)(e.admonition,{type:"warning",children:[(0,i.jsx)(e.mdxAdmonitionTitle,{}),(0,i.jsx)(e.p,{children:"When reading the ADC, it is important to distinguish between the maximum digital count and the maximum input voltage. The function"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"const MAX_VALUE: u32 = adc::resolution_to_max_count(adc::Resolution::BITS14);\n"})}),(0,i.jsx)(e.p,{children:"returns the largest integer code that the ADC can produce for a 14\u2011bit conversion."}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["For a 14\u2011bit ADC, the digital output spans from 0 to ",(0,i.jsx)(e.code,{children:"2^14 - 1 = 16383"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"MAX_VALUE"})," will therefore hold the value ",(0,i.jsx)(e.code,{children:"16383"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:["This is not the maximum voltage that the ADC can measure. The maximum voltage is determined by the reference voltage (e.g., 3.3 V), while ",(0,i.jsx)(e.code,{children:"MAX_VALUE"})," simply represents the highest possible digital code."]}),"\n"]})]}),(0,i.jsx)(e.p,{children:"Once we have the ADC and pin set up, we can start reading values from the pin. Here\u2019s a simple loop that reads the raw ADC value, converts it to a voltage, and prints it:"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:'loop {\n    // Read a raw ADC value (blocking read)\n    let level: u16 = adc.blocking_read(&mut adc_pin);\n    let voltage = 3.3f32 * level as f32 / MAX_VALUE as f32;\n\n    info!("Light sensor reading: {}, voltage: {}", level, voltage);\n\n    // Wait a bit before reading again\n    embassy_time::Timer::after_secs(1).await;\n}\n'})})]}),(0,i.jsxs)(r.A,{value:"rp2350",label:"Raspberry Pi Pico 1 / 2",default:!0,children:[(0,i.jsxs)(e.p,{children:["On the RP2040, ADC uses an interrupt called ",(0,i.jsx)(e.code,{children:"ADC_IRQ_FIFO"})," to signal whenever a new sample has been added to the ADCs' FIFO. This new sample will be stored inside a FIFO. In the Embassy library, this interrupt is already implemented, so all we need to do is bind it and use it in our ADC variable."]}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"// Bind the `ADC_IRQ_FIFO` interrupt to the Embassy's ADC handler\nbind_interrupts!(struct Irqs {\n    ADC_IRQ_FIFO => InterruptHandler;\n});\n\n// ---- fn main() ----\n\n// Initialize peripherals\nlet peripherals = embassy_rp::init(Default::default());\n\n// Create ADC driver\nlet mut adc = Adc::new(peripherals.ADC, Irqs, Config::default());\n"})}),(0,i.jsxs)(e.admonition,{type:"warning",children:[(0,i.jsxs)(e.p,{children:["If we are using PWM and ADC in the same code, we will have two different ",(0,i.jsx)(e.code,{children:"Config"})," imports with the same name. In order to avoid compilation errors, we need to separate the PWM config import from the ADC one. To do this, we can import the two ",(0,i.jsx)(e.code,{children:"Config"}),"s with different names."]}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"use embassy_rp::pwm::Config as ConfigPwm; // PWM config\nuse embassy_rp::adc::Config as ConfigAdc; // ADC config\n\n// ---- fn main() ----\nlet mut adc = Adc::new(peripherals.ADC, Irqs, ConfigAdc::default());\n"})})]}),(0,i.jsxs)(e.admonition,{type:"warning",children:[(0,i.jsx)(e.mdxAdmonitionTitle,{}),(0,i.jsx)(e.p,{children:"Since the RP2s uses a 12\u2011bit ADC, the maximum representable digital value is 4095."})]}),(0,i.jsxs)(e.p,{children:["Now, we need to initialize the ADC pin we will be using. The Raspberry Pi Pico has 3 pins that support ADC: ",(0,i.jsx)(e.code,{children:"ADC0"}),", ",(0,i.jsx)(e.code,{children:"ADC1"}),", and ",(0,i.jsx)(e.code,{children:"ADC2"}),"."]}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:"// Initialize ADC pin\n// X should be replaced with a pin number\nlet mut adc_pin = Channel::new_pin(peripherals.PIN_X, Pull::None); \n"})}),(0,i.jsx)(e.p,{children:"Once we have the ADC and pin set up, we can start reading values from the pin."}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-rust",children:'loop {\n    // read a value from the pin\n    let level = adc.read(&mut adc_pin).await.unwrap(); \n\n    // print the value over serial\n    info!("Light sensor reading: {}", level); \n\n    // wait a bit before reading and printing another value\n    Timer::after_secs(1).await; \n}\n'})})]})]}),"\n",(0,i.jsxs)(e.admonition,{type:"info",children:[(0,i.jsxs)(e.p,{children:["Cortex\u2011M33 cores include a hardware Floating Point Unit (FPU), but ",(0,i.jsxs)(e.strong,{children:["only for single precision (",(0,i.jsx)(e.code,{children:"f32"}),")"]}),".",(0,i.jsx)(e.br,{}),"\n","Double precision (",(0,i.jsx)(e.code,{children:"f64"}),") is emulated in software and runs much slower.",(0,i.jsx)(e.br,{}),"\n","Cortex\u2011M0 cores have ",(0,i.jsx)(e.strong,{children:"no FPU at all"}),", so all floating\u2011point math is emulated."]}),(0,i.jsxs)(e.p,{children:["For clarity, examples here use volts represented as ",(0,i.jsx)(e.code,{children:"f32"})," instead of millivolts.",(0,i.jsx)(e.br,{}),"\n","On RP2040 (Cortex\u2011M0+), floating\u2011point operations are ",(0,i.jsx)(e.strong,{children:"very slow"}),".",(0,i.jsx)(e.br,{}),"\n","For efficiency, prefer ",(0,i.jsx)(e.strong,{children:"integer arithmetic in mV"})," expressed as ",(0,i.jsx)(e.code,{children:"u32"})," in performance\u2011sensitive code."]})]}),"\n",(0,i.jsx)(e.h2,{id:"exercises",children:"Exercises"}),"\n",(0,i.jsxs)(e.admonition,{type:"info",children:[(0,i.jsxs)(e.p,{children:["If you need to remember the layout of the board, check the ",(0,i.jsx)(e.a,{href:"./02#the-lab-board",children:"Lab Board"})," section from the previous lab."]}),(0,i.jsxs)(e.p,{children:["Remember that LEDs are wired so they light up on ",(0,i.jsx)(e.code,{children:"Level::Low"})," and turn off on ",(0,i.jsx)(e.code,{children:"Level::High"})," and buttons return ",(0,i.jsx)(e.code,{children:"Level::Low"})," when pressed and ",(0,i.jsx)(e.code,{children:"Level::High"})," when not pressed."]})]}),"\n",(0,i.jsxs)(e.admonition,{type:"danger",children:[(0,i.jsx)(e.mdxAdmonitionTitle,{}),(0,i.jsx)(e.p,{children:"Please make sure the lab professor verifies your circuit before it is powered up."})]}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["Write a program using Embassy that adjusts the brightness of an LED connected to GPIO pin by changing the PWM duty cycle.","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Light up the LED at 25% intensity. (",(0,i.jsx)(e.strong,{children:"1p"}),")"]}),"\n",(0,i.jsxs)(e.li,{children:["Make the LED change intensity from 0% to 100% in 10% increments every 1 second. (",(0,i.jsx)(e.strong,{children:"1p"}),")"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.admonition,{type:"info",children:[(0,i.jsxs)(e.p,{children:["You should use the lab skeleton provided in the ",(0,i.jsx)(e.a,{href:"https://github.com/UPB-PMRust/lab-2025",children:"Lab Repository"})," as a starting point for your implementation."]}),(0,i.jsxs)(e.p,{children:["Embassy will reset all the peripherals when the ",(0,i.jsx)(e.code,{children:"main"})," function exits, that means ",(0,i.jsx)(e.code,{children:"PWM"})," and ",(0,i.jsx)(e.code,{children:"ADC"})," will stop. Make sure the ",(0,i.jsx)(e.code,{children:"main"})," function never exits so you can see how the circuit behaves."]})]}),"\n",(0,i.jsxs)(e.ol,{start:"2",children:["\n",(0,i.jsxs)(e.li,{children:["Write a program using Embassy to control the led intensity using a potentiometer. The potentiometer is connected to an ADC-capable GPIO pin. The LED should change intensity based on the potentiometer's position. (",(0,i.jsx)(e.strong,{children:"2p"}),")"]}),"\n"]}),"\n",(0,i.jsxs)(e.admonition,{type:"warning",children:[(0,i.jsx)(e.mdxAdmonitionTitle,{}),(0,i.jsx)(e.p,{children:"Unlike the photoresistor, which requires an external resistor to form a voltage divider, a potentiometer already has an internal voltage divider. You only need to connect its three pins:"}),(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"One leg to VCC."}),"\n",(0,i.jsx)(e.li,{children:"The middle pin to an ADC-capable GPIO pin."}),"\n",(0,i.jsx)(e.li,{children:"One leg to GND."}),"\n"]}),(0,i.jsxs)(e.p,{children:["(The potentiometer that the board provides is signaled with label ",(0,i.jsx)(e.code,{children:"POTENTIOMETER"})," in the connectors section.)"]})]}),"\n",(0,i.jsxs)(e.ol,{start:"3",children:["\n",(0,i.jsxs)(e.li,{children:["Make the RGB LED switch from red -> yellow -> blue every time the button ",(0,i.jsx)(e.code,{children:"S4"})," is pressed. (",(0,i.jsx)(e.strong,{children:"2p"}),")"]}),"\n"]}),"\n",(0,i.jsx)(e.admonition,{type:"note",children:(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"PC6"}),", ",(0,i.jsx)(e.code,{children:"PB4"}),", and ",(0,i.jsx)(e.code,{children:"PB10"})," can be used to control an RGB LED. Although ",(0,i.jsx)(e.code,{children:"PC6"})," and ",(0,i.jsx)(e.code,{children:"PB4"})," share the same PWM channel and therefore have the same frequency, each pin can have an ",(0,i.jsx)(e.strong,{children:"independent duty cycle"}),", allowing individual control of the brightness for each color."]})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"Colors",src:a(93119).A+"",width:"354",height:"309"})}),"\n",(0,i.jsxs)(e.ol,{start:"4",children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Write a program using Embassy that measures light intensity using a photoresistor connected to ADC."}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Use ",(0,i.jsx)(e.code,{children:"defmt"})," to display the measured light intensity. (",(0,i.jsx)(e.strong,{children:"1p"}),")"]}),"\n",(0,i.jsxs)(e.li,{children:["Make the RGB LED change color based on the light intensity. Red for low intensity, green for medium intensity, and blue for high intensity. (",(0,i.jsx)(e.strong,{children:"1p"}),")"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Write a program using Embassy that moves a servo motor smoothly between 0\xb0 and 180\xb0, then back to 0\xb0, in a continuous loop. (",(0,i.jsx)(e.strong,{children:"2p"}),")"]}),"\n"]}),"\n"]})]})}function x(s={}){const{wrapper:e}={...(0,l.R)(),...s.components};return e?(0,i.jsx)(e,{...s,children:(0,i.jsx)(o,{...s})}):o(s)}},19365:(s,e,a)=>{a.d(e,{A:()=>t});a(96540);var n=a(34164);const i={tabItem:"tabItem_Ymn6"};var l=a(74848);function t({children:s,hidden:e,className:a}){return(0,l.jsx)("div",{role:"tabpanel",className:(0,n.A)(i.tabItem,a),hidden:e,children:s})}},11470:(s,e,a)=>{a.d(e,{A:()=>b});var n=a(96540),i=a(34164),l=a(17559),t=a(23104),r=a(56347),c=a(205),h=a(57485),m=a(31682),d=a(70679);function o(s){return n.Children.toArray(s).filter((s=>"\n"!==s)).map((s=>{if(!s||(0,n.isValidElement)(s)&&function(s){const{props:e}=s;return!!e&&"object"==typeof e&&"value"in e}(s))return s;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof s.type?s.type:s.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function x(s){const{values:e,children:a}=s;return(0,n.useMemo)((()=>{const s=e??function(s){return o(s).map((({props:{value:s,label:e,attributes:a,default:n}})=>({value:s,label:e,attributes:a,default:n})))}(a);return function(s){const e=(0,m.XI)(s,((s,e)=>s.value===e.value));if(e.length>0)throw new Error(`Docusaurus error: Duplicate values "${e.map((s=>s.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(s),s}),[e,a])}function p({value:s,tabValues:e}){return e.some((e=>e.value===s))}function j({queryString:s=!1,groupId:e}){const a=(0,r.W6)(),i=function({queryString:s=!1,groupId:e}){if("string"==typeof s)return s;if(!1===s)return null;if(!0===s&&!e)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return e??null}({queryString:s,groupId:e});return[(0,h.aZ)(i),(0,n.useCallback)((s=>{if(!i)return;const e=new URLSearchParams(a.location.search);e.set(i,s),a.replace({...a.location,search:e.toString()})}),[i,a])]}function g(s){const{defaultValue:e,queryString:a=!1,groupId:i}=s,l=x(s),[t,r]=(0,n.useState)((()=>function({defaultValue:s,tabValues:e}){if(0===e.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(s){if(!p({value:s,tabValues:e}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${s}" but none of its children has the corresponding value. Available values are: ${e.map((s=>s.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return s}const a=e.find((s=>s.default))??e[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:e,tabValues:l}))),[h,m]=j({queryString:a,groupId:i}),[o,g]=function({groupId:s}){const e=function(s){return s?`docusaurus.tab.${s}`:null}(s),[a,i]=(0,d.Dv)(e);return[a,(0,n.useCallback)((s=>{e&&i.set(s)}),[e,i])]}({groupId:i}),u=(()=>{const s=h??o;return p({value:s,tabValues:l})?s:null})();(0,c.A)((()=>{u&&r(u)}),[u]);return{selectedValue:t,selectValue:(0,n.useCallback)((s=>{if(!p({value:s,tabValues:l}))throw new Error(`Can't select invalid tab value=${s}`);r(s),m(s),g(s)}),[m,g,l]),tabValues:l}}var u=a(92303);const N={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var y=a(74848);function f({className:s,block:e,selectedValue:a,selectValue:n,tabValues:l}){const r=[],{blockElementScrollPositionUntilNextRender:c}=(0,t.a_)(),h=s=>{const e=s.currentTarget,i=r.indexOf(e),t=l[i].value;t!==a&&(c(e),n(t))},m=s=>{let e=null;switch(s.key){case"Enter":h(s);break;case"ArrowRight":{const a=r.indexOf(s.currentTarget)+1;e=r[a]??r[0];break}case"ArrowLeft":{const a=r.indexOf(s.currentTarget)-1;e=r[a]??r[r.length-1];break}}e?.focus()};return(0,y.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":e},s),children:l.map((({value:s,label:e,attributes:n})=>(0,y.jsx)("li",{role:"tab",tabIndex:a===s?0:-1,"aria-selected":a===s,ref:s=>{r.push(s)},onKeyDown:m,onClick:h,...n,className:(0,i.A)("tabs__item",N.tabItem,n?.className,{"tabs__item--active":a===s}),children:e??s},s)))})}function v({lazy:s,children:e,selectedValue:a}){const l=(Array.isArray(e)?e:[e]).filter(Boolean);if(s){const s=l.find((s=>s.props.value===a));return s?(0,n.cloneElement)(s,{className:(0,i.A)("margin-top--md",s.props.className)}):null}return(0,y.jsx)("div",{className:"margin-top--md",children:l.map(((s,e)=>(0,n.cloneElement)(s,{key:e,hidden:s.props.value!==a})))})}function w(s){const e=g(s);return(0,y.jsxs)("div",{className:(0,i.A)(l.G.tabs.container,"tabs-container",N.tabList),children:[(0,y.jsx)(f,{...e,...s}),(0,y.jsx)(v,{...e,...s})]})}function b(s){const e=(0,u.A)();return(0,y.jsx)(w,{...s,children:o(s.children)},String(e))}},43755:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/alarm-9123adf62510936424b4888da274f82c.svg"},73640:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/analog_signal-ee6e6499b17b16b8767bfa035eef7f27.png"},29563:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/board_photoresistor-b86a3821e57bba6988f80a75442e2a4c.jpg"},87559:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/board_rgb-9b943c738872af6e5407c6d80cf50354.jpg"},63946:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/clock_signal-49541bcc52f09f14d1e19e36915c823f.png"},93119:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/colors-5c3fa50830d1fe6674ca97582baefa2a.png"},62621:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/common_anode_common_cathode-ce7bd74b3251fdefd860a43293453a4f.png"},13728:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/counter-f510d875d964f5993ebfa39e196df625.svg"},54744:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/digital_signal-fb5afef385984f5a23322d339559c85d.png"},80820:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/duty_cycle-1ff8d97f4bd060f866d5c6065da60c99.png"},59463:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/hse-3cd2d69363428797edb45d2615486ade.png"},22501:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/nyquist_theorem-436cb31254d8dc2736da55165cb16b26.png"},48306:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/photoresistor-93b2c60234e6e6ce1015f694e550fce1.png"},61413:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/photoresistor_wiring-fec82e46ceca20f9018410bce236b23e.png"},67718:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/pulse-width-modulation-signal-diagrams-average-e8f71f3620c486efcdefc7756a750c3b.png"},70066:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/pwm_led-ab77a3a86e59318f34cdadd308ea309f.gif"},7855:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/pwm_rp2040_example-25843139fb0e6b4d0cb5b1e385005a4b.png"},51257:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/pwm_rp2040_pins-e137303e1adb1dead3ab8080d2a9a75f.png"},9450:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/rp_crystal-efcca4da8116b36900130ee21ac95135.png"},88192:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/sampling_values-44d287bb9a945455cd1168efe4352357.svg"},37089:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/servo_pins-6ad0d0a8866611b7f7d1326795a66968.jpg"},82087:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/servo_wires-a2275ca73009abf09069bfe67692cb2a.png"},22258:(s,e,a)=>{a.d(e,{A:()=>n});const n=a.p+"assets/images/stm32u545re_timers_cont-867ee8753bb889738facdf04519a5f8f.png"},28453:(s,e,a)=>{a.d(e,{R:()=>t,x:()=>r});var n=a(96540);const i={},l=n.createContext(i);function t(s){const e=n.useContext(l);return n.useMemo((function(){return"function"==typeof s?s(e):{...e,...s}}),[e,s])}function r(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(i):s.components||i:t(s.components),n.createElement(l.Provider,{value:e},s.children)}}}]);